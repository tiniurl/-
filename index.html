<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8">
    <title>Xem video Discord</title>
    <style>
      body {
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        color: white;
      }
      video {
        max-width: 90%;
        max-height: 90%;
      }
    </style>
  </head>
  <body>
    <video id="player" controls autoplay style="display:none;">
      <source id="videoSource" type="video/mp4">
      Trình duyệt của bạn không hỗ trợ video.
    </video>

    <script>
      // Lấy toàn bộ URL hiện tại (dạng thô, không bị cắt bởi &)
      const fullUrl = window.location.href;
      const marker = '?url=';
      const idx = fullUrl.indexOf(marker);

      if (idx !== -1) {
        // Lấy toàn bộ chuỗi sau ?url=
        const videoUrl = fullUrl.substring(idx + marker.length);
        const decoded = decodeURIComponent(videoUrl);

        const player = document.getElementById('player');
        const source = document.getElementById('videoSource');
        source.src = decoded;
        player.style.display = 'block';
        player.load();
      } else {
        document.body.innerHTML = `
          <p style="text-align:center;">
            ❌ Không tìm thấy video.<br>
            Vui lòng truy cập theo dạng:<br>
            <code>?url=https://cdn.discordapp.com/.../video.mp4?ex=...</code>
          </p>`;
      }
    </script>
  </body>
</html>
