<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="referrer" content="no-referrer">
  <link rel="icon" type="ico" href="/-/tiniurl.ico">
  <title>Short link ‚Äî Redirecting‚Ä¶</title>

  <!-- ü™û Meta preview -->
  <meta property="og:title" content="Short link ‚Äî Redirecting‚Ä¶">
  <meta property="og:description" content="Trang n√†y s·∫Ω t·ª± ƒë·ªông chuy·ªÉn b·∫°n ƒë·∫øn li√™n k·∫øt ƒë√≠ch sau v√†i gi√¢y.">
  <meta property="og:type" content="website">

  <style>
    :root {
      color-scheme: light dark;
      --bg: #fafafa;
      --fg: #111;
      --card-bg: #fff;
      --shadow: rgba(0,0,0,.08);
      --link: #0366d6;
      --border: #ddd;
      --muted: #777;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #111;
        --fg: #eee;
        --card-bg: #1e1e1e;
        --shadow: rgba(0,0,0,.3);
        --link: #58a6ff;
        --border: #444;
        --muted: #aaa;
      }
    }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial;
      margin: 2rem;
      color: var(--fg);
      text-align: center;
      background: var(--bg);
      transition: background 0.3s, color 0.3s;
    }
    .card {
      display: inline-block;
      max-width: 680px;
      width: 90%;
      padding: 1.8rem;
      border-radius: 14px;
      background: var(--card-bg);
      box-shadow: 0 6px 18px var(--shadow);
      word-wrap: break-word;
      overflow-wrap: anywhere;
      transition: background 0.3s, box-shadow 0.3s;
      animation: fadeIn 0.4s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: none; }
    }
    h1 {
      font-weight: 600;
      font-size: 1.6rem;
      margin-bottom: 0.3rem;
    }
    p { line-height: 1.6; margin: 0.6rem 0; }
    a.button {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.7rem 1.2rem;
      border-radius: 8px;
      text-decoration: none;
      border: 1px solid var(--border);
      color: var(--link);
      background: transparent;
      transition: all 0.2s ease;
      max-width: 100%;
      word-break: break-all;
      overflow-wrap: anywhere;
      font-weight: 500;
    }
    a.button:hover {
      background: var(--link);
      color: white;
      border-color: var(--link);
    }
    #countdown {
      font-size: 1.1rem;
      color: var(--muted);
      margin-top: 0.6rem;
    }
    .small {
      font-size: 0.9rem;
      color: var(--muted);
      margin-top: 0.8rem;
    }
  </style>
</head>
<body>
  <div class="card" role="alert">
    <h1 id="title">ƒêang chuy·ªÉn h∆∞·ªõng‚Ä¶</h1>
    <p id="desc">Trang n√†y s·∫Ω t·ª± ƒë·ªông chuy·ªÉn sau v√†i gi√¢y.</p>
    <p><a id="destLink" class="button" href="#">ƒêi ƒë·∫øn trang ƒë√≠ch</a></p>
    <p id="countdown">ƒêang t·∫£i...</p>
    <p class="small">N·∫øu trang kh√¥ng t·ª± chuy·ªÉn, h√£y b·∫•m v√†o n√∫t tr√™n.</p>
  </div>

  <script>
  (async function(){
    const msg = document.getElementById('countdown');
    const linkEl = document.getElementById('destLink');
    const titleEl = document.getElementById('title');
    const descEl = document.getElementById('desc');

    const parts = location.pathname.split('/').filter(Boolean);
    const slug = parts.pop();
    const repo = parts[0];

    if (!slug) {
      msg.textContent = 'Kh√¥ng c√≥ m√£ r√∫t g·ªçn.';
      return;
    }

    try {
      const res = await fetch(`/${repo}/links.json`, { cache: 'no-cache' });
      if (!res.ok) throw new Error(`fetch failed: ${res.status}`);
      const links = await res.json();

      const data = links[slug];
      if (data && data.url) {
        const dest = data.url;

        titleEl.textContent = data.title || 'ƒêang chuy·ªÉn h∆∞·ªõng‚Ä¶';
        descEl.textContent = data.desc || 'Trang n√†y s·∫Ω t·ª± ƒë·ªông chuy·ªÉn b·∫°n ƒë·∫øn li√™n k·∫øt ƒë√≠ch.';

        let secondsLeft = 5;
        linkEl.href = dest;
        try {
          const u = new URL(dest);
          linkEl.textContent = 'ƒêi ƒë·∫øn: ' + u.hostname + u.pathname;
        } catch {
          linkEl.textContent = 'ƒêi ƒë·∫øn trang ƒë√≠ch';
        }

        msg.textContent = `Chuy·ªÉn sau ${secondsLeft} gi√¢y...`;

        const timer = setInterval(() => {
          secondsLeft--;
          msg.textContent = `Chuy·ªÉn sau ${secondsLeft} gi√¢y...`;
          if (secondsLeft <= 0) {
            clearInterval(timer);

            // Fix scroll tr√™n desktop t·ª´ YouTube
            if (dest.includes('#') || dest.includes(':~:text=')) {
              const hashIndex = dest.indexOf('#');
              if (hashIndex !== -1) {
                const urlWithoutHash = dest.substring(0, hashIndex);
                const hash = dest.substring(hashIndex);
                // Load trang tr∆∞·ªõc, sau ƒë√≥ th√™m hash ƒë·ªÉ scroll ƒë√∫ng
                window.location.href = urlWithoutHash;
                setTimeout(() => {
                  window.location.href = dest;
                }, 50);
              } else {
                // :~:text= scroll tr·ª±c ti·∫øp
                window.location.href = dest;
              }
            } else {
              window.location.href = dest;
            }
          }
        }, 1000);
      } else {
        titleEl.textContent = 'Li√™n k·∫øt kh√¥ng t·ªìn t·∫°i!';
        msg.textContent = `Kh√¥ng t√¨m th·∫•y "${slug}" trong links.json.`;
        linkEl.style.display = 'none';
      }
    } catch (err) {
      console.error(err);
      titleEl.textContent = 'L·ªói t·∫£i d·ªØ li·ªáu';
      msg.textContent = 'Kh√¥ng th·ªÉ t·∫£i links.json.';
      linkEl.style.display = 'none';
    }
  })();
  </script>
</body>
</html>
